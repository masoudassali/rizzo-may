<!DOCTYPE html>
<html>
<head>
<title>rizzooo-may!</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    line-height: 1.6;
    margin: 20px;
    background-color: #f4f7f6;
    color: #333;
    padding-bottom: 120px; /* more space for footer */
  }

  /* Your original CSS (shortened here for this message) */
  /* ... (you already have all the styles you pasted earlier) ... */

  footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    background-color: #222;
    color: #ccc;
    font-size: 0.8em;
    font-style: italic;
    padding: 10px 20px;
    text-align: center;
    line-height: 1.4;
  }

  footer a {
    color: #ccc;
    text-decoration: underline;
  }

</style>
</head>
<body>

<h2>rizzooo-may!</h2>
<p>Yes you may. Customize your resume to job applications.<br>
  <b>3 simple (free) steps:</b></p>

<!-- Your form -->
<form id="uploadForm" enctype="multipart/form-data" action="https://steak.servequake.com/webhook/56d59214-83ea-4bbf-bcca-b67ed32a1261" method="POST">
  <!-- Form Sections Here -->
  <!-- ... (message textarea, file inputs, submit button, etc.) ... -->
</form>

<!-- Upload Status and Response Area -->
<div id="uploadStatusContainer">
  <div id="uploadStatusBar">0%</div>
</div>
<div id="uploadStatusText">Uploading...</div>

<div id="responseContainer" style="display: none;">
    <h3>Processing Results:</h3>
    <div id="responseAreaContainer">
        <div id="responseArea"></div>
        <button id="copyButton" class="copy-code-button">Copy</button>
    </div>
</div>

<!-- Your FULL JavaScript starts here -->
<script>
// Global variable for the counter span element
let counterDisplaySpan = null;
const localStorageKey = 'rizzoooMaySubmissionCount';
let currentCount = localStorage.getItem(localStorageKey);

// Wait for the DOM to be fully loaded before initializing most script parts
document.addEventListener('DOMContentLoaded', function() {

    counterDisplaySpan = document.getElementById('submissionCountDisplay');

    if (!counterDisplaySpan) {
        console.error("Submission count display span not found in footer! Counter will not display.");
    } else {
        if (currentCount === null || isNaN(parseInt(currentCount, 10))) {
            currentCount = 431;
            localStorage.setItem(localStorageKey, currentCount);
        } else {
            currentCount = parseInt(currentCount, 10);
        }
        counterDisplaySpan.textContent = currentCount;
    }

    const dropdownTrigger = document.getElementById('promptDropdownTrigger');
    const dropdownPanel = document.getElementById('promptDropdownPanel');
    const addSelectedButton = document.getElementById('addSelectedPrompts');

    dropdownTrigger.addEventListener('click', function(event) {
        event.stopPropagation();
        const isVisible = dropdownPanel.style.display === 'flex';
        dropdownPanel.style.display = isVisible ? 'none' : 'flex';
        const arrow = this.querySelector('.arrow');
        if(arrow) {
            arrow.textContent = isVisible ? '▼' : '▲';
        }
    });

    document.addEventListener('click', function(event) {
        if (!dropdownTrigger.contains(event.target) && !dropdownPanel.contains(event.target)) {
            dropdownPanel.style.display = 'none';
            const arrow = dropdownTrigger.querySelector('.arrow');
            if(arrow) { arrow.textContent = '▼'; }
        }
    });

    dropdownPanel.addEventListener('click', function(event) {
        event.stopPropagation();
    });

    addSelectedButton.addEventListener('click', function() {
        const textarea = document.getElementById('userMessage');
        const checkboxes = dropdownPanel.querySelectorAll('input[type="checkbox"]:checked');
        let selectedPromptsText = '';

        checkboxes.forEach(checkbox => {
            const promptText = checkbox.dataset.prompt || checkbox.nextElementSibling.textContent;
            selectedPromptsText += promptText + '\n';
            checkbox.checked = false;
        });

        if (selectedPromptsText.length > 0) {
             const prefix = textarea.value.length > 0 && !textarea.value.endsWith('\n') ? '\n' : '';
             textarea.value += prefix + selectedPromptsText;
             textarea.scrollTop = textarea.scrollHeight;
             textarea.focus();
        }

        dropdownPanel.style.display = 'none';
        const arrow = dropdownTrigger.querySelector('.arrow');
        if(arrow) { arrow.textContent = '▼'; }
    });

    document.getElementById('uploadForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const form = this;
        const formData = new FormData(form);
        const responseArea = document.getElementById('responseArea');
        const responseContainer = document.getElementById('responseContainer');
        const copyButton = document.getElementById('copyButton');
        const uploadStatusContainer = document.getElementById('uploadStatusContainer');
        const uploadStatusBar = document.getElementById('uploadStatusBar');
        const uploadStatusText = document.getElementById('uploadStatusText');
        const submitButton = form.querySelector('input[type="submit"]');

        responseContainer.style.display = 'block';
        responseArea.innerHTML = 'Generating... shouldn\'t take more than a couple of minutes.';
        responseArea.style.color = '#000';
        responseArea.style.backgroundColor = '#e9ecef';
        responseArea.style.borderColor = '#eee';
        copyButton.style.display = 'none';
        copyButton.textContent = 'Copy';
        copyButton.classList.remove('copied');
        submitButton.disabled = true;

        uploadStatusContainer.style.display = 'block';
        uploadStatusText.style.display = 'block';
        uploadStatusBar.style.width = '0%';
        uploadStatusBar.innerHTML = '0%';
        uploadStatusText.innerHTML = "Starting upload...";

        const xhr = new XMLHttpRequest();

        xhr.upload.onprogress = function(event) {
            if (event.lengthComputable) {
                const percentComplete = (event.loaded / event.total) * 100;
                const percent = Math.round(percentComplete);
                uploadStatusBar.style.width = percent + '%';
                uploadStatusBar.innerHTML = percent + '%';
                uploadStatusText.innerHTML = `Uploading files (${percent}%)...`;
            }
        };

        xhr.onloadstart = function() {
            uploadStatusBar.style.width = '100%';
            uploadStatusBar.innerHTML = '100%';
            uploadStatusText.innerHTML = "Processing... shouldn't take more than a couple of minutes.";
        };

        xhr.onload = function() {
            if (xhr.status >= 200 && xhr.status < 300) {
                if (counterDisplaySpan) {
                    if (typeof currentCount !== 'number' || isNaN(currentCount)) {
                        currentCount = localStorage.getItem(localStorageKey);
                        if (currentCount === null || isNaN(parseInt(currentCount, 10))) {
                            currentCount = 431;
                        } else {
                            currentCount = parseInt(currentCount, 10);
                        }
                    }
                    currentCount++;
                    localStorage.setItem(localStorageKey, currentCount);
                    counterDisplaySpan.textContent = currentCount;
                }

                try {
                    const data = JSON.parse(xhr.responseText);
                    const customizedResumeText = data.customizedResume || JSON.stringify(data, null, 2);
                    responseArea.innerHTML = '<pre>' + customizedResumeText + '</pre>';
                    uploadStatusText.innerHTML = "Generated!";
                    responseArea.style.color = '#333';
                    responseArea.style.backgroundColor = '#d4edda';
                    responseArea.style.borderColor = '#c3e6cb';
                    copyButton.style.display = 'inline-block';
                } catch (e) {
                    console.error('Error parsing JSON response:', e, xhr.responseText);
                    responseArea.innerHTML = '<p>Error: Unexpected server response.</p>';
                    uploadStatusText.innerHTML = "Generation failed (Parse Error).";
                    responseArea.style.color = '#721c24';
                    responseArea.style.backgroundColor = '#f8d7da';
                    responseArea.style.borderColor = '#f5c6cb';
                }
            } else {
                console.error('HTTP error!', xhr.status, xhr.responseText);
                responseArea.innerHTML = '<p>Error processing files: HTTP ' + xhr.status + '</p>';
                uploadStatusText.innerHTML = `Error: ${xhr.status}`;
                responseArea.style.color = '#721c24';
                responseArea.style.backgroundColor = '#f8d7da';
                responseArea.style.borderColor = '#f5c6cb';
            }

            uploadStatusContainer.style.display = 'none';
            submitButton.disabled = false;
        };

        xhr.onerror = function() {
            console.error('Network error!');
            uploadStatusContainer.style.display = 'none';
            responseArea.innerHTML = '<p>Network error. Please try again.</p>';
            responseArea.style.color = '#721c24';
            responseArea.style.backgroundColor = '#f8d7da';
            responseArea.style.borderColor = '#f5c6cb';
            uploadStatusText.innerHTML = "Network error.";
            submitButton.disabled = false;
        };

        xhr.ontimeout = function() {
            console.error('Request timed out!');
            uploadStatusContainer.style.display = 'none';
            responseArea.innerHTML = '<p>Request timed out. Please try again later.</p>';
            responseArea.style.color = '#721c24';
            responseArea.style.backgroundColor = '#f8d7da';
            responseArea.style.borderColor = '#f5c6cb';
            uploadStatusText.innerHTML = "Request timed out.";
            submitButton.disabled = false;
        };

        xhr.open(this.method, this.action);
        xhr.send(formData);
    });
});

// Copy Button functionality
document.getElementById('copyButton').addEventListener('click', function(event) {
    event.stopPropagation();
    const responseArea = document.getElementById('responseArea');
    const textToCopy = responseArea.innerText;

    navigator.clipboard.writeText(textToCopy)
        .then(() => {
            const button = document.getElementById('copyButton');
            button.textContent = 'Copied!';
            button.classList.add('copied');
            setTimeout(() => {
                button.textContent = 'Copy';
                button.classList.remove('copied');
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy text: ', err);
            const button = document.getElementById('copyButton');
            button.textContent = 'Copy Failed!';
        });
});
</script>
<!-- End of your FULL JS -->

<!-- Your new Footer -->
<footer>
  [v0.4] Made with ♥ in Sunnyvale, CA — Rights reserved © 2025 — 
  For feedback or connecting: 
  <a href="https://linkedin.com/in/masassali" target="_blank">linkedin.com/in/masassali</a> — 
  <span>Resume generation count: <span id="submissionCountDisplay">0</span></span>
</footer>

</body>
</html>
