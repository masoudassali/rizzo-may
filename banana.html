<!DOCTYPE html>
<html>
<head>
<title>rizzooo-may!</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    line-height: 1.6;
    margin: 20px;
    background-color: #f4f7f6; /* Light background */
    color: #333; /* Default text color */
    padding-bottom: 80px; /* Add padding at the bottom to make space for the fixed footer */
  }

  h2 {
    color: #333;
    border-bottom: 2px solid #007bff; /* A little underline */
    padding-bottom: 10px;
  }

  h3 {
    color: #555;
    margin-top: 0;
    margin-bottom: 10px;
  }

  p { /* Style for general paragraphs */
      margin-bottom: 15px;
  }

  ol {
    /* margin-bottom: 20px; */
    /* padding-left: 20px; */
  }

  ol li {
      /* margin-bottom: 5px; */
  }

  /* Styles for the form container using Flexbox */
  form {
    margin-bottom: 30px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 8px; /* More rounded corners */
    background-color: #fff; /* White form background */
    box-shadow: 0 2px 4px rgba(0 0 0 / 10%); /* Subtle shadow */
    display: flex; /* Use Flexbox for the form container */
    flex-direction: column; /* Stack form sections vertically */
    gap: 20px; /* Add space between form sections */
  }

  /* Apply box-sizing for more predictable width */
  form *, form *:before, form *:after {
    box-sizing: border-box;
  }

  /* Style for each main section within the form (message, files, button) */
  .form-section {
      display: flex;
      flex-direction: column; /* Stack elements within each section (label, input/textarea) */
      gap: 8px; /* Space between label and input/textarea */
  }

  /* --- Specific styles for the message section to accommodate drag-and-drop suggestions --- */
  .form-section.message-section {
      flex-direction: row; /* Arrange children (textarea container and suggestions) side-by-side on desktop */
      gap: 20px; /* Space between the textarea area and the suggestions box */
      flex-wrap: wrap; /* Allow stacking on smaller screens */
      align-items: flex-start; /* Align items to the top */
  }

  .message-textarea-container {
      flex: 2; /* Allow the textarea container to take up more space */
      display: flex; /* Use flex to stack label and textarea inside */
      flex-direction: column;
      gap: 8px; /* Space between label and textarea */
      min-width: 280px; /* Ensure minimum width before wrapping */
  }

  .prompt-suggestions {
      flex: 1; /* Allow the suggestions list to take the remaining space */
      min-width: 200px; /* Minimum width before wrapping */
      background-color: #f8f8f8; /* Light background for the suggestions box */
      border: 1px solid #eee;
      border-radius: 4px;
      padding: 15px;
      display: flex; /* Use flex to stack heading and list */
      flex-direction: column;
      gap: 10px; /* Space between paragraph and ul */
  }

  .prompt-suggestions p {
      font-weight: bold;
      margin-bottom: 0; /* Gap handles spacing */
      font-size: 0.9em;
      color: #555;
  }

  .prompt-suggestions ul {
      list-style: none; /* Remove default bullets */
      padding: 0;
      margin: 0;
  }

  .prompt-suggestions li {
      background-color: #e9ecef; /* Light grey background for each suggestion */
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 8px;
      margin-bottom: 5px; /* Space between list items */
      cursor: grab; /* Indicate draggable */
      font-size: 0.9em;
      transition: background-color 0.2s ease;
  }

  .prompt-suggestions li:last-child {
      margin-bottom: 0; /* Remove margin from the last list item */
  }

  .prompt-suggestions li:hover {
      background-color: #d0d4d7; /* Darker on hover */
  }

  /* Optional style when dragging over the textarea */
  /* textarea.drag-over {
      border-color: #007bff;
      box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
  } */
  /* --- End specific styles for message section --- */


  label {
    display: block; /* Labels are block elements */
    font-weight: bold;
    color: #555;
  }

  input[type="file"],
  textarea {
    display: block; /* Ensure they take up their flex area */
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background-color: #f8f8f8;
    width: 100%; /* Make them fill the width of their parent flex item */
  }

  textarea {
      resize: vertical; /* Allow only vertical resizing */
      min-height: 100px; /* Give textarea a minimum height */
  }

   input[type="file"] {
       resize: none;
   }

    /* Styles for the container holding side-by-side file inputs */
    .file-inputs-container {
        display: flex; /* Use Flexbox for side-by-side layout */
        gap: 20px; /* Space between the two file input groups */
        flex-wrap: wrap; /* Allow wrapping to a new line on smaller screens */
    }

    /* Style for each individual file input group (Flex items within file-inputs-container) */
    .file-input-group {
        flex: 1; /* Allow each group to grow and shrink equally */
        min-width: 250px; /* Minimum width before wrapping */
        display: flex; /* Use Flexbox for label and input within the group */
        flex-direction: column; /* Stack label and input vertically within the group */
        gap: 5px; /* Space between label and input within the group */
    }

    .file-input-group label {
        margin-bottom: 0; /* Gap handles spacing */
    }


  /* Revised CSS for input[type="submit"] - use max-width and margin: auto, placed in its own section */
  input[type="submit"] {
    padding: 10px 20px; /* More padding */
    background-color: #007bff; /* Primary blue color */
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s ease; /* Smooth hover effect */
    display: block; /* Make it a block element to use margin: auto for centering */
    width: auto; /* Let width be determined by content/padding initially */
    max-width: 300px; /* Limit maximum width on desktop */
    margin: 0 auto; /* Center the block button horizontally within its parent .form-section */
  }

  input[type="submit"]:hover {
    background-color: #0056b3; /* Darker blue on hover */
  }

  input[type="submit"]:disabled { /* Style for disabled button */
    background-color: #cccccc;
    cursor: not-allowed;
  }

  /* Styles for the upload status bar */
  #uploadStatusContainer {
      width: 100%;
      background-color: #ddd;
      display: none; /* Initially hidden */
      margin-top: 15px; /* Keep this margin */
      border-radius: 4px;
      overflow: hidden; /* Ensure the status bar stays within bounds */
  }

  #uploadStatusBar {
      width: 0%;
      height: 20px;
      background-color: #4CAF50; /* Green color for the bar */
      text-align: center;
      line-height: 20px; /* Vertically center text */
      color: white;
      border-radius: 4px;
      transition: width 0.3s ease; /* Smooth animation for the bar */
      font-size: 0.8em; /* Smaller text */
  }

   #uploadStatusText {
      margin-top: 5px; /* Keep this margin */
      font-size: 0.9em;
      color: #555;
      display: none; /* Initially hidden */
      text-align: center;
   }


  /* Styles for the response area */
  #responseContainer { /* Container for response header, button, and area */
      margin-top: 20px; /* Keep this margin */
  }

  #responseHeader {
      display: flex; /* Use flexbox to align header and button */
      align-items: center; /* Vertically align */
      gap: 15px; /* Space between header and button */
      margin-bottom: 10px;
  }

  #copyButton {
      padding: 5px 15px;
      background-color: #6c757d; /* Grey color for button */
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s ease;
  }

  #copyButton:hover {
    background-color: #5a6268; /* Darker grey on hover */
  }

  #copyButton.copied { /* Style when text is copied */
      background-color: #28a745; /* Green */
      color: white;
  }


  #responseArea {
    padding: 15px;
    border: 1px solid #eee;
    border-radius: 8px;
    background-color: #e9ecef; /* Light grey background for response */
    white-space: pre-wrap;
    word-wrap: break-word;
    min-height: 50px; /* Give it a minimum height */
    color: #333; /* Default text color */
    overflow-x: auto; /* Add horizontal scroll if content is too wide */
  }

  #responseArea pre { /* Style for pre tag inside response area */
      margin: 0; /* Remove default margin from pre */
      padding: 0;
  }


  #responseArea p { /* Style for paragraph messages inside response area */
      margin: 5px 0;
      padding: 0;
  }

  #responseArea code { /* Style for code blocks inside response area */
      background-color: #f8f9fa;
      padding: 2px 4px;
      border-radius: 4px;
      font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
      font-size: 0.9em;
  }

  /* Styles for the footer */
  footer {
      position: fixed; /* Fix footer to the bottom */
      left: 0;
      bottom: 0;
      width: 100%;
      background-color: #333; /* Dark background */
      color: #f4f7f6; /* Light text */
      text-align: center;
      padding: 10px 20px;
      font-size: 0.8em; /* Small font size */
      z-index: 10; /* Ensure footer is above other content if needed */
  }

  footer p {
      margin: 0; /* Remove margin from footer paragraph */
      padding: 0;
  }

    footer a {
        color: #f4f7f6; /* Light color for links in footer */
        text-decoration: none; /* Remove underline */
    }

    footer a:hover {
        text-decoration: underline; /* Underline on hover */
    }

    /* Style for the counter span inside the footer */
    footer #submissionCountDisplay {
        font-weight: bold; /* Make the count stand out */
        margin-left: 5px; /* Add a little space after "Total Submissions:" */
    }


  /* Optional: Add some responsive adjustments */
  @media (max-width: 768px) { /* Adjust breakpoint for message section stacking */
      body {
          margin: 10px;
          padding-bottom: 100px; /* Increase padding for potentially taller footer on mobile */
      }
      form {
          padding: 15px;
      }
      /* Stack message section vertically on smaller screens */
      .form-section.message-section {
          flex-direction: column;
          gap: 15px; /* Adjust gap for vertical stacking */
          align-items: stretch; /* Allow children to stretch */
      }
       .message-textarea-container,
       .prompt-suggestions {
           flex: none; /* Remove flex grow/shrink on mobile */
           width: 100%; /* Take full width on mobile */
           min-width: auto; /* Remove min-width constraint */
       }


      /* Button styles for mobile - full width, no centering */
      input[type="submit"] {
          width: 100%;
          max-width: none;
          margin: 0; /* Remove auto margin */
          text-align: center;
      }
       /* Button section on mobile - remove centering as button is full width */
      .button-section {
          align-items: stretch; /* Allow button to stretch */
      }

       /* Adjust file inputs to stack on mobile */
       .file-inputs-container {
           flex-direction: column; /* Stack items vertically on small screens */
           gap: 15px; /* Adjust gap for vertical stacking */
       }
       .file-input-group {
           min-width: auto; /* Remove min-width constraint on mobile */
           width: 100%; /* Ensure they take full width when stacked */
           gap: 5px; /* Keep space between label and input */
       }

      #responseHeader {
          flex-direction: column; /* Stack header and button on small screens */
          align-items: flex-start;
          gap: 5px;
      }
       #copyButton {
           width: auto; /* Auto width on small screens */
       }
        footer {
            font-size: 0.7em; /* Smaller font on small screens */
            padding: 8px 10px;
            line-height: 1.4; /* Adjust line height for smaller font */
        }
        footer p {
            margin: 0; /* Ensure no extra margin */
        }

  }

</style>
</head>
<body>

<h2>rizzooo-may!</h2>
<p><b>Free <i>(beta): </i></b>Customize your resume for job applications.<br>3 simple steps:</p>


<form id="uploadForm" enctype="multipart/form-data" action="https://steak.servequake.com/webhook-test/b1592350-e356-44e8-98b6-26b21b1c36b8" method="POST">
  <div class="form-section message-section">
    <div class="message-textarea-container">
        <label for="userMessage">Give me some points on what your resume should focus on, (e.g. clean it up, use x industry terms, etc.)</label>
        <textarea name="userMessage" id="userMessage" rows="4" cols="50"></textarea>
    </div>
    <div class="prompt-suggestions">
        <p>Drag-n-drop these or add your own:</p>
        <ul>
            <li class="draggable-prompt" draggable="true" data-prompt="Clean up and proofread">Clean up and proofread</li>
            <li class="draggable-prompt" draggable="true" data-prompt="Use [Industry] terms">Use [Industry] terms</li>
            <li class="draggable-prompt" draggable="true" data-prompt="Emphasize [Skill] experience">Emphasize [Skill] experience</li>
            <li class="draggable-prompt" draggable="true" data-prompt="Incorporate ATS keywords">Incorporate ATS keywords</li>
            <li class="draggable-prompt" draggable="true" data-prompt="Strengthen action verbs and numbers">Strengthen action verbs and numbers</li>
            <li class="draggable-prompt" draggable="true" data-prompt="Condense to one page">Condense to one page</li>
        </ul>
    </div>
  </div>


  <div class="form-section">
    <p>Upload files (text file &lt; 1mb)</p>

    <div class="file-inputs-container">
      <div class="file-input-group">
        <label for="file1">Add Resume:</label>
        <input type="file" name="file1" id="file1" required>
      </div>
      <div class="file-input-group">
        <label for="file2">Add Job Description:</label>
        <input type="file" name="file2" id="file2" required>
      </div>
    </div>
  </div>


  <div class="form-section button-section">
    <input type="submit" value="Generate Resume">
  </div>

</form>

<div id="uploadStatusContainer">
  <div id="uploadStatusBar">0%</div>
</div>
<div id="uploadStatusText">Uploading...</div>


<div id="responseContainer" style="display: none;">
    <div id="responseHeader">
        <h3>Processing Results:</h3> <button id="copyButton">Copy Text</button>
    </div>
    <div id="responseArea">
      </div>
</div>


<script>
// Global variable for the counter span element
let counterDisplaySpan = null;
const localStorageKey = 'rizzoooMaySubmissionCount';
let currentCount = localStorage.getItem(localStorageKey); // Read initial count globally


// Wait for the DOM to be fully loaded before initializing most script parts
document.addEventListener('DOMContentLoaded', function() {

    // --- Submission Counter Initialization ---
    // Get the counter span element once the DOM is loaded
    counterDisplaySpan = document.getElementById('submissionCountDisplay');

    // Check if the element was found
    if (!counterDisplaySpan) {
        console.error("Submission count display span not found in footer! Counter will not display.");
        // No need to exit here, other parts of the script can still run
    } else {
         // Update the text content of the span with the current count on load
        if (currentCount === null || isNaN(parseInt(currentCount, 10))) { // Also checks if initial read was NaN
            currentCount = 431; // Start count if no previous valid count is found
            localStorage.setItem(localStorageKey, currentCount); // Save initial count
        } else {
             currentCount = parseInt(currentCount, 10); // Ensure it's a number
        }
        counterDisplaySpan.textContent = currentCount;
    }

    // --- Drag and Drop Functionality for Prompts ---
    const textarea = document.getElementById('userMessage');
    const draggablePrompts = document.querySelectorAll('.draggable-prompt');

    // Add dragstart listener to each draggable prompt
    draggablePrompts.forEach(prompt => {
        prompt.addEventListener('dragstart', function(event) {
            // Set the data to be transferred - use the data-prompt attribute or text content
            event.dataTransfer.setData('text/plain', this.dataset.prompt || this.textContent);
            // Optional: Set a drag image
            // event.dataTransfer.setDragImage(this, 0, 0);
        });
    });

    // Add dragover listener to the textarea (the drop target)
    textarea.addEventListener('dragover', function(event) {
        // Prevent default to allow dropping
        event.preventDefault();
        // Optional: Add a class to indicate a drop target is active
        // this.classList.add('drag-over');
    });

    // Add dragleave listener to remove the drag-over class (optional)
    // textarea.addEventListener('dragleave', function(event) {
    //     this.classList.remove('drag-over');
    // });


    // Add drop listener to the textarea
    textarea.addEventListener('drop', function(event) {
        // Prevent default action (like opening the data as a link)
        event.preventDefault();

        // Remove the drag-over class (optional)
        // this.classList.remove('drag-over');

        // Get the data that was set in dragstart
        const data = event.dataTransfer.getData('text/plain');

        // Get the current cursor position in the textarea
        const cursorPosition = this.selectionStart;

        // Get the current value of the textarea
        const currentValue = this.value;

        // Insert the dropped text at the cursor position, followed by a newline
        const textToInsert = data + '\n';
        const newValue = currentValue.substring(0, cursorPosition) + textToInsert + currentValue.substring(cursorPosition);

        // Update the textarea's value
        this.value = newValue;

        // Optional: Set the cursor position after the inserted text
        this.selectionStart = this.selectionEnd = cursorPosition + textToInsert.length;

        // Trigger input or change event if needed for frameworks (not strictly needed for plain JS)
        // const inputEvent = new Event('input', { bubbles: true });
        // this.dispatchEvent(inputEvent);
    });


    // --- Form Submission Handling ---
    document.getElementById('uploadForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent default form submission

        const form = this;
        const formData = new FormData(form);

        const responseArea = document.getElementById('responseArea');
        const responseContainer = document.getElementById('responseContainer');
        const copyButton = document.getElementById('copyButton');
        const uploadStatusContainer = document.getElementById('uploadStatusContainer');
        const uploadStatusBar = document.getElementById('uploadStatusBar');
        const uploadStatusText = document.getElementById('uploadStatusText');
        const submitButton = form.querySelector('input[type="submit"]');


        // --- Reset and Show UI Elements ---
        responseContainer.style.display = 'block';
        // Initial text for response area while generating
        responseArea.innerHTML = 'Generating... shouldn\'t take more than a couple of minutes.';
        responseArea.style.color = '#000';
        responseArea.style.backgroundColor = '#e9ecef';
        responseArea.style.borderColor = '#eee';
        copyButton.style.display = 'none';
        copyButton.textContent = 'Copy Text';
        copyButton.classList.remove('copied');
        submitButton.disabled = true; // Disable button during upload

        // Show and reset status bar
        uploadStatusContainer.style.display = 'block';
        uploadStatusText.style.display = 'block';
        uploadStatusBar.style.width = '0%'; // Reset progress bar width
        uploadStatusBar.innerHTML = '0%'; // Reset percentage text inside bar
        // Status text below the bar throughout the process until completion/error
        uploadStatusText.innerHTML = "Generating... shouldn't take more than a couple of minutes.";


        // --- Create and Configure XMLHttpRequest ---
        const xhr = new XMLHttpRequest();

        // --- Track Upload Progress ---
        xhr.upload.onprogress = function(event) {
            if (event.lengthComputable) {
                const percentComplete = (event.loaded / event.total) * 100;
                const percent = Math.round(percentComplete); // Round for display
                // Update progress bar width
                uploadStatusBar.style.width = percent + '%';
                // Update the text inside the status bar div (e.g., "0%", "50%", "100%")
                // Only update percentage if less than 100 to make space for "Processing..."
                if (percent < 100) {
                     uploadStatusBar.innerHTML = percent + '%';
                }
                // Text below the bar remains "Generating..." during this phase
            }
        };

        // --- Handle Request Completion (Success or Failure) ---
        xhr.onload = function() {
            // Request has completed (either success or failure status)

            submitButton.disabled = false; // Re-enable submit button

            // Set final status text inside the bar (will be hidden shortly)
            if(uploadStatusBar) { // Check exists
               uploadStatusBar.innerHTML = xhr.status >= 200 && xhr.status < 300 ? '100%' : 'Error'; // Show 100% or Error in bar
            }


            if (xhr.status >= 200 && xhr.status < 300) {
                // Request was successful (HTTP status 2xx)

                // --- Increment and save counter on successful submission ---
                // Only increment if the counter span was found initially
                if (counterDisplaySpan) {
                    // Ensure currentCount is a number before incrementing
                     if (typeof currentCount !== 'number' || isNaN(currentCount)) {
                         // If for some reason currentCount isn't a number here, re-read it
                         currentCount = localStorage.getItem(localStorageKey);
                         if (currentCount === null || isNaN(parseInt(currentCount, 10))) {
                            currentCount = 431;
                         } else {
                             currentCount = parseInt(currentCount, 10);
                         }
                     }
                    currentCount++;
                    localStorage.setItem(localStorageKey, currentCount);
                    // Update the text content of the span in the footer
                    counterDisplaySpan.textContent = currentCount;
                }
                // --- End counter update ---


                try {
                    const data = JSON.parse(xhr.responseText); // Attempt to parse the JSON response from client

                    // Display the response from client (assuming JSON with customizedResume key)
                    const customizedResumeText = data.customizedResume || JSON.stringify(data, null, 2); // Use customizedResume if present, fallback to full JSON

                    responseArea.innerHTML = '<pre>' + customizedResumeText + '</pre>'; // Display text nicely formatted

                    // Update final status text below the bar on success
                    uploadStatusText.innerHTML = "Generated!";


                    responseArea.style.color = '#333'; // Dark grey for success
                    responseArea.style.backgroundColor = '#d4edda'; // Light green for success background
                    responseArea.style.borderColor = '#c3e6cb'; // Green border
                    copyButton.style.display = 'inline-block'; // Show the copy button


                } catch (e) {
                    // Failed to parse the JSON response (e.g., client returned plain text or invalid JSON on success)
                    console.error('Error parsing JSON response:', e, 'Response:', xhr.responseText);
                    responseArea.innerHTML = '<p>Error: Received unexpected response from client.</p><p><code>' + xhr.responseText.substring(0, 500) + '...</code></p>'; // Display partial response text

                    // Update final status text below the bar on parse error
                    uploadStatusText.innerHTML = "Generation failed (Parse Error).";

                    responseArea.style.color = '#721c24'; // Dark red for error
                    responseArea.style.backgroundColor = '#f8d7da'; // Light red for error background
                    responseArea.style.borderColor = '#f5c6cb';
                }

            } else {
                // Request failed (HTTP status is not 2xx)
                console.error('HTTP error!', xhr.status, xhr.responseText);
                let errorMessage = `HTTP error! status: ${xhr.status}`;
                try {
                    // Attempt to parse client's error response if it's JSON
                    const errorResponse = JSON.parse(xhr.responseText);
                    if (errorResponse.message) {
                        errorMessage += `, message: ${errorResponse.message}`;
                    } else {
                        errorMessage += `, body: ${xhr.responseText}`;
                    }
                } catch (e) {
                    // If response isn't JSON, just include the status and response text
                    errorMessage += `, body: ${xhr.responseText}`;
                }

                responseArea.innerHTML = '<p>Error processing files:</p><p><code>' + errorMessage + '</code></p>';
                 // Update final status text below the bar on HTTP error
                uploadStatusText.innerHTML = `Error: ${xhr.status}`;


                responseArea.style.color = '#721c24';
                responseArea.style.backgroundColor = '#f8d7da';
                responseArea.style.borderColor = '#f5c6cb';
            }
             // Update status text inside the bar to indicate completion or error
            if(uploadStatusBar) { // Check exists
                 uploadStatusBar.innerHTML = uploadStatusText.innerHTML; // Copy final text to the bar
            }

            // Hide status bar container (the bar itself)
            uploadStatusContainer.style.display = 'none';
            // Keep uploadStatusText visible with the final message

        }; // End xhr.onload

        // --- Handle Network Errors (like connection refused) ---
        xhr.onerror = function() {
            console.error('Network error!');
            // Hide status bar container
            uploadStatusContainer.style.display = 'none';
            // uploadStatusText.style.display = 'none'; // Keep status text visible
            submitButton.disabled = false; // Re-enable submit button


            responseArea.innerHTML = '<p>Error processing files:</p><p><code>Network request failed. Please check your connection or the server status.</code></p>';
            responseArea.style.color = '#721c24';
            responseArea.style.backgroundColor = '#f8d7da';
            responseArea.style.borderColor = '#f5c6cb';
            // Update final status text below the bar on network error
            uploadStatusText.innerHTML = "Network error.";
             // Update status text inside the bar
            if(uploadStatusBar) { uploadStatusBar.innerHTML = uploadStatusText.innerHTML; }
        };

        // --- Handle Request Timeout ---
        xhr.ontimeout = function() {
            console.error('Request timed out!');
            uploadStatusContainer.style.display = 'none';
            // uploadStatusText.style.display = 'none'; // Keep status text visible
            submitButton.disabled = false;

            responseArea.innerHTML = '<p>Error processing files:</p><p><code>Request timed out. The server took too long to respond.</code></p>';
            responseArea.style.color = '#721c24';
            responseArea.style.backgroundColor = '#f8d7da';
            responseArea.style.borderColor = '#f5c6cb';
             // Update final status text below the bar on timeout error
            uploadStatusText.innerHTML = "Request timed out.";
            // Update status text inside the bar
             if(uploadStatusBar) { uploadStatusBar.innerHTML = uploadStatusText.innerHTML; }
        };


        // --- Open and Send the Request ---
        // IMPORTANT: Replace "https://steak.servequake.com/webhook-test/b1592350-e356-44e8-98b6-26b21b1c36b8" with your actual production client webhook URL
        xhr.open(this.method, this.action); // Use the form's method (POST) and action URL
        // When sending FormData with XHR, the browser automatically sets the Content-Type
        // and boundary header correctly. Do NOT set Content-Type manually here.

        xhr.send(formData); // Send the FormData object containing both files and textarea data

        // Initial text for response area while generating (redundant with responseArea.innerHTML update above)
        // responseArea.innerHTML = 'Generating...';

    });
}); // End DOMContentLoaded listener

// Add event listener for the copy button (remains the same)
// This is outside DOMContentLoaded as it relies on the copy button existing,
// which it does when the page is parsed. It doesn't need to wait for the full DOM.
document.getElementById('copyButton').addEventListener('click', function() {
    const responseArea = document.getElementById('responseArea');
    // Get ALL text content from the response area div
    const textToCopy = responseArea.innerText; // Use innerText for simplicity

    navigator.clipboard.writeText(textToCopy)
        .then(() => {
            const button = document.getElementById('copyButton');
            button.textContent = 'Copied!';
            button.classList.add('copied');
            setTimeout(() => {
                button.textContent = 'Copy Text';
                button.classList.remove('copied');
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy text: ', err);
             const button = document.getElementById('copyButton');
             button.textContent = 'Copy Failed!';
        });
});

</script>

<footer>
    <p>Made with &nbsp;<span style="color: hotpink;">&hearts;</span>&nbsp; in Sunnyvale, CA — Reach out: <a href="https://www.linkedin.com/in/masassali" target="_blank">linkedin.com/in/masassali</a> — Last submission count: <span id="submissionCountDisplay">Loading...</span></p>
</footer>


</body>
</html>
